var t={};t=class{constructor(t,e,s,i,a,r){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.gameField=t,this.buttonStart=e,this.messageLose=i,this.messageWin=a,this.messageStart=r,this.gameScore=s,this.score=0,this.idle=!0,this.playing=!1,this.lose=!1,this.win=!1}moveLeft(){let t=!1;for(let e=0;e<this.board.length;e++){let s=this.board[e].filter(t=>0!==t),i=[];for(let e=0;e<s.length;e++)if(s[e]===s[e+1]){let a=2*s[e];i.push(a),this.score+=a,t=!0,e++}else i.push(s[e]);for(;i.length<this.board[e].length;)i.push(0);JSON.stringify(this.board[e])!==JSON.stringify(i)&&(this.board[e]=i,t=!0)}t&&this.addRandomTile()}moveRight(){let t=!1;for(let e=0;e<this.board.length;e++){let s=this.board[e].filter(t=>0!==t).reverse(),i=[];for(let e=0;e<s.length;e++)if(s[e]===s[e+1]){let a=2*s[e];i.push(a),this.score+=a,t=!0,e++}else i.push(s[e]);for(;i.length<this.board[e].length;)i.push(0);i.reverse(),JSON.stringify(this.board[e])!==JSON.stringify(i)&&(this.board[e]=i,t=!0)}t&&this.addRandomTile()}moveUp(){let t=!1;for(let e=0;e<this.board.length;e++){let s=this.board.map(t=>t[e]).filter(t=>0!==t),i=[];for(let e=0;e<s.length;e++)if(s[e]===s[e+1]){let a=2*s[e];i.push(a),this.score+=a,t=!0,e++}else i.push(s[e]);for(;i.length<this.board.length;)i.push(0);for(let s=0;s<this.board.length;s++)this.board[s][e]!==i[s]&&(this.board[s][e]=i[s],t=!0)}t&&this.addRandomTile()}moveDown(){let t=!1;for(let e=0;e<this.board.length;e++){let s=this.board.map(t=>t[e]).filter(t=>0!==t).reverse(),i=[];for(let e=0;e<s.length;e++)if(e<s.length-1&&s[e]===s[e+1]){let a=2*s[e];i.push(a),this.score+=a,t=!0,e++}else i.push(s[e]);for(;i.length<this.board.length;)i.push(0);i.reverse();for(let s=0;s<this.board.length;s++)this.board[s][e]!==i[s]&&(this.board[s][e]=i[s],t=!0)}t&&this.addRandomTile()}makeMove(){document.addEventListener("keydown",t=>{switch(t.key){case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown();break;case"ArrowLeft":this.moveLeft();break;case"ArrowRight":this.moveRight()}this.updateGameField(),this.getScore(),this.checkWin(),this.canMakeMove()})}getScore(){this.gameScore.textContent=this.score}getState(){return this.board.map(t=>[...t])}getStatus(){return this.idle?"idle":this.lose?"lose":this.win?"win":this.playing?"playing":void 0}start(){this.playing||(this.addRandomTile(),this.addRandomTile(),this.getState(),this.updateButton("restart"),this.playing=!0,this.idle=!1,this.messageStart.className="message message-start hidden",this.messageLose.className="message message-lose hidden",this.messageWin.className="message message-win hidden")}restart(){this.playing&&(this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.getScore(),this.updateGameField(),this.updateButton("start"),this.idle=!0,this.playing=!1,this.messageStart.className="message message-start",this.messageLose.className="message message-lose hidden",this.messageWin.className="message message-win hidden")}addRandomTile(){let t=[];for(let e=0;e<this.board.length;e++)for(let s=0;s<this.board[e].length;s++)0===this.board[e][s]&&t.push({row:e,col:s});if(t.length>0){let e=Math.floor(Math.random()*t.length),{row:s,col:i}=t[e];this.board[s][i]=.9>Math.random()?2:4,this.gameField.rows[s].cells[i].textContent=this.board[s][i],this.gameField.rows[s].cells[i].className=`field-cell field-cell--${this.board[s][i]}`}}updateButton(t){"start"===t?(this.buttonStart.classList.add("start"),this.buttonStart.classList.remove("restart"),this.buttonStart.textContent="Start"):"restart"===t&&(this.buttonStart.classList.remove("start"),this.buttonStart.classList.add("restart"),this.buttonStart.textContent="Restart")}updateGameField(){for(let t=0;t<this.board.length;t++)for(let e=0;e<this.board[t].length;e++)this.gameField.rows[t].cells[e].textContent=0===this.board[t][e]?"":this.board[t][e],this.gameField.rows[t].cells[e].className=0===this.board[t][e]?"field-cell":`field-cell field-cell--${this.board[t][e]}`}canMakeMove(){for(let t=0;t<this.board.length;t++)for(let e=0;e<this.board[t].length;e++)if(0===this.board[t][e]||e<this.board[t].length-1&&this.board[t][e]===this.board[t][e+1]||t<this.board.length-1&&this.board[t][e]===this.board[t+1][e]){this.lose=!1;return}this.lose=!0,this.messageLose.classList.remove("hidden")}checkWin(){for(let t=0;t<this.board.length;t++)for(let e=0;e<this.board[t].length;e++)2024===this.board[t][e]&&(this.win=!0,this.messageWin.classList.remove("hidden"))}};const e=document.querySelector(".game-field"),s=document.querySelector(".game-score"),i=document.querySelector(".start"),a=new t(e,i,s,document.querySelector(".message-lose"),document.querySelector(".message-win"),document.querySelector(".message-start"));i.addEventListener("click",()=>{a.playing?a.restart():a.start()}),a.makeMove();
//# sourceMappingURL=index.37b77a7a.js.map
