!function(){var e={};function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}e=function(){var e;function r(e,t,a,s,o,i){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,r),this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.gameField=e,this.buttonStart=t,this.messageLose=s,this.messageWin=o,this.messageStart=i,this.gameScore=a,this.score=0,this.idle=!0,this.playing=!1,this.lose=!1,this.win=!1}return e=[{key:"moveLeft",value:function(){for(var e=this,t=!1,r=0;r<this.board.length;r++)!function(r){for(var a=e.board[r].filter(function(e){return 0!==e}),s=[],o=0;o<a.length;o++)if(a[o]===a[o+1]){var i=2*a[o];s.push(i),e.score+=i,t=!0,o++}else s.push(a[o]);for(;s.length<e.board[r].length;)s.push(0);JSON.stringify(e.board[r])!==JSON.stringify(s)&&(e.board[r]=s,t=!0)}(r);t&&this.addRandomTile()}},{key:"moveRight",value:function(){for(var e=this,t=!1,r=0;r<this.board.length;r++)!function(r){for(var a=e.board[r].filter(function(e){return 0!==e}).reverse(),s=[],o=0;o<a.length;o++)if(a[o]===a[o+1]){var i=2*a[o];s.push(i),e.score+=i,t=!0,o++}else s.push(a[o]);for(;s.length<e.board[r].length;)s.push(0);s.reverse(),JSON.stringify(e.board[r])!==JSON.stringify(s)&&(e.board[r]=s,t=!0)}(r);t&&this.addRandomTile()}},{key:"moveUp",value:function(){for(var e=this,t=function(t){for(var a=e.board.map(function(e){return e[t]}).filter(function(e){return 0!==e}),s=[],o=0;o<a.length;o++)if(a[o]===a[o+1]){var i=2*a[o];s.push(i),e.score+=i,r=!0,o++}else s.push(a[o]);for(;s.length<e.board.length;)s.push(0);for(var n=0;n<e.board.length;n++)e.board[n][t]!==s[n]&&(e.board[n][t]=s[n],r=!0)},r=!1,a=0;a<this.board.length;a++)t(a);r&&this.addRandomTile()}},{key:"moveDown",value:function(){for(var e=this,t=function(t){for(var a=e.board.map(function(e){return e[t]}).filter(function(e){return 0!==e}).reverse(),s=[],o=0;o<a.length;o++)if(o<a.length-1&&a[o]===a[o+1]){var i=2*a[o];s.push(i),e.score+=i,r=!0,o++}else s.push(a[o]);for(;s.length<e.board.length;)s.push(0);s.reverse();for(var n=0;n<e.board.length;n++)e.board[n][t]!==s[n]&&(e.board[n][t]=s[n],r=!0)},r=!1,a=0;a<this.board.length;a++)t(a);r&&this.addRandomTile()}},{key:"makeMove",value:function(){var e=this;document.addEventListener("keydown",function(t){switch(t.key){case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown();break;case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight()}e.updateGameField(),e.getScore(),e.checkWin(),e.canMakeMove()})}},{key:"getScore",value:function(){this.gameScore.textContent=this.score}},{key:"getState",value:function(){return this.board.map(function(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return t(e,void 0);var a=Object.prototype.toString.call(e).slice(8,-1);if("Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()})}},{key:"getStatus",value:function(){return this.idle?"idle":this.lose?"lose":this.win?"win":this.playing?"playing":void 0}},{key:"start",value:function(){this.playing||(this.addRandomTile(),this.addRandomTile(),this.getState(),this.updateButton("restart"),this.playing=!0,this.idle=!1,this.messageStart.className="message message-start hidden",this.messageLose.className="message message-lose hidden",this.messageWin.className="message message-win hidden")}},{key:"restart",value:function(){this.playing&&(this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.getScore(),this.updateGameField(),this.updateButton("start"),this.idle=!0,this.playing=!1,this.messageStart.className="message message-start",this.messageLose.className="message message-lose hidden",this.messageWin.className="message message-win hidden")}},{key:"addRandomTile",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var r=0;r<this.board[t].length;r++)0===this.board[t][r]&&e.push({row:t,col:r});if(e.length>0){var a=Math.floor(Math.random()*e.length),s=e[a],o=s.row,i=s.col;this.board[o][i]=.9>Math.random()?2:4,this.gameField.rows[o].cells[i].textContent=this.board[o][i],this.gameField.rows[o].cells[i].className="field-cell field-cell--".concat(this.board[o][i])}}},{key:"updateButton",value:function(e){"start"===e?(this.buttonStart.classList.add("start"),this.buttonStart.classList.remove("restart"),this.buttonStart.textContent="Start"):"restart"===e&&(this.buttonStart.classList.remove("start"),this.buttonStart.classList.add("restart"),this.buttonStart.textContent="Restart")}},{key:"updateGameField",value:function(){for(var e=0;e<this.board.length;e++)for(var t=0;t<this.board[e].length;t++)this.gameField.rows[e].cells[t].textContent=0===this.board[e][t]?"":this.board[e][t],this.gameField.rows[e].cells[t].className=0===this.board[e][t]?"field-cell":"field-cell field-cell--".concat(this.board[e][t])}},{key:"canMakeMove",value:function(){for(var e=0;e<this.board.length;e++)for(var t=0;t<this.board[e].length;t++)if(0===this.board[e][t]||t<this.board[e].length-1&&this.board[e][t]===this.board[e][t+1]||e<this.board.length-1&&this.board[e][t]===this.board[e+1][t]){this.lose=!1;return}this.lose=!0,this.messageLose.classList.remove("hidden")}},{key:"checkWin",value:function(){for(var e=0;e<this.board.length;e++)for(var t=0;t<this.board[e].length;t++)2024===this.board[e][t]&&(this.win=!0,this.messageWin.classList.remove("hidden"))}}],function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(r.prototype,e),r}();var r=document.querySelector(".game-field"),a=document.querySelector(".game-score"),s=document.querySelector(".start"),o=new e(r,s,a,document.querySelector(".message-lose"),document.querySelector(".message-win"),document.querySelector(".message-start"));s.addEventListener("click",function(){o.playing?o.restart():o.start()}),o.makeMove()}();
//# sourceMappingURL=index.b13ce732.js.map
